{% load crispy_forms_tags %}
<!-- templates/tasks/modals/add-subtask-modal.html -->
<div class="modal fade" id="addSubtaskModal" tabindex="-1" aria-labelledby="addSubtaskModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content border-0 shadow-sm rounded-4">
            <div class="modal-header bg-primary text-white rounded-top">
                <h5 class="modal-title" id="addSubtaskModalLabel">
                    <i class="fas fa-user-plus me-2"></i>Add Subtask
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <div class="modal-body">
                <form method="post" action="{% url 'tasks:add_subtask_modal' task.id %}" class="was-validated">
                    {% csrf_token %}
                    
                    <div class="mb-3">
                        <label for="id_user" class="form-label">Assign to Graphics Team Member:</label>
                        {% if subtask_form.user.field.queryset.exists %}
                            {{ subtask_form.user }}
                        {% else %}
                            <div class="alert alert-warning">
                                No available Graphics team members to assign.
                            </div>
                        {% endif %}
                        {% if subtask_form.user.errors %}
                            <div class="invalid-feedback d-block">
                                {{ subtask_form.user.errors }}
                            </div>
                        {% endif %}
                    </div>
                    
                    <div class="mb-3">
                        <label for="id_notes" class="form-label">Notes:</label>
                        {{ subtask_form.notes_from_top }}
                    </div>
                    
                    <div class="d-flex justify-content-end gap-2">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary" {% if not subtask_form.user.field.queryset.exists %}disabled{% endif %}>
                            Save Subtask
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
